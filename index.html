<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>Index</title>
</head>
<body>

<h3>首页</h3>

<button id="sendMsg2">主进程向渲染进程发送消息</button>

<button id="makeNewWindow">创建多个渲染进程</button>

<button id="sendMsg3">多个渲染进程向主进程发送同样的消息，消息发送完成之后，需要主进程响应消息给发送者，也就是发送消息给对应的渲染进程</button>

<span>查看控制台消息</span>

<script>
    let {ipcRenderer, remote} = require('electron')

    // 渲染进程向主进程发送消息
    document.querySelector('#sendMsg2').addEventListener('click', () => {
        ipcRenderer.send('msg_render2main', {name: 'param1'}, {name: 'param2'})
        // 同步传递消息，渲染进程不需要监听，当消息发送调用成功时，返回值即为主进程设置的 event.returnValue 的值
        // let returnValue = ipcRenderer.sendSync('msg_render2main', {name: 'param1'}, {name: 'param2'})
    })

    // 主进程向渲染进程发送消息
    ipcRenderer.on('msg_main2render', (event, param1, param2) => {
        console.log('渲染进程接收到消息1', param1)
        console.log('渲染进程接收到消息2', param2)
        console.log('渲染进程接收到发送者', event.sender)
    })

    // 创建多个渲染进程
    let win = null;
    document.querySelector('#makeNewWindow').addEventListener('click', function () {
        win = new remote.BrowserWindow({
            webPreferences: {
                nodeIntegration: true
            }
        })
        win.loadFile('index.html')
    })

    // 渲染进程向主进程发送消息
    document.querySelector('#sendMsg3').addEventListener('click', () => {
        ipcRenderer.send('msg_render3main', {name: 'param1'}, {name: 'param2'})
    })

    // 主进程向渲染进程发送消息
    ipcRenderer.on('msg_main3render', (event, param1, param2) => {
        console.log('渲染进程接收到消息1', param1)
        console.log('渲染进程接收到消息2', param2)
        console.log('渲染进程接收到发送者', event.sender)
    })

</script>

</body>
</html>
